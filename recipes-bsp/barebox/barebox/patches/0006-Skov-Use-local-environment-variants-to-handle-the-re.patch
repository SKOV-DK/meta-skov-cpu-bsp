From: Juergen Borleis <jbe@pengutronix.de>
Date: Fri, 20 Nov 2015 15:35:58 +0100
Subject: [PATCH] Skov: Use local environment variants to handle the regular
 use case (bootchooser and NAND)

Signed-off-by: Juergen Borleis <jbe@pengutronix.de>
---
 arch/arm/boards/skov-dol63x/env/boot/bootchooser | 14 ++++++++++++++
 arch/arm/boards/skov-dol63x/env/init/automount   | 14 ++++++++++++++
 arch/arm/boards/skov-dol63x/env/nv/boot.default  |  1 +
 3 files changed, 29 insertions(+)
 create mode 100644 arch/arm/boards/skov-dol63x/env/boot/bootchooser
 create mode 100644 arch/arm/boards/skov-dol63x/env/init/automount
 create mode 100644 arch/arm/boards/skov-dol63x/env/nv/boot.default

diff --git a/arch/arm/boards/skov-dol63x/env/boot/bootchooser b/arch/arm/boards/skov-dol63x/env/boot/bootchooser
new file mode 100644
index 000000000000..c553f35891b3
--- /dev/null
+++ b/arch/arm/boards/skov-dol63x/env/boot/bootchooser
@@ -0,0 +1,14 @@
+#!/bin/sh
+
+if [ "${global.system.reset}" = "POR" ]; then
+    # reset
+    opt=-r
+else
+    # decrement
+    opt=-d
+fi
+
+# Verbose
+# Rerty with decrement
+# enable watchdog with timepuit from state
+bootchooser -v -R -w $opt
diff --git a/arch/arm/boards/skov-dol63x/env/init/automount b/arch/arm/boards/skov-dol63x/env/init/automount
new file mode 100644
index 000000000000..bc9ff48a0afb
--- /dev/null
+++ b/arch/arm/boards/skov-dol63x/env/init/automount
@@ -0,0 +1,14 @@
+#!/bin/sh
+
+if [ "$1" = menu ]; then
+	init-menu-add-entry "$0" "Automountpoints"
+	exit
+fi
+
+# development support
+mkdir -p /mnt/tftp
+automount /mnt/tftp 'ifup eth0 && mount -t tftp $eth0.serverip /mnt/tftp'
+
+# regular SD card based boot procedure
+mkdir -p /mnt/sd
+automount -d /mnt/sd 'mmc2.probe=1 && mount -t ext4 /dev/mmc2.0 /mnt/sd'
diff --git a/arch/arm/boards/skov-dol63x/env/nv/boot.default b/arch/arm/boards/skov-dol63x/env/nv/boot.default
new file mode 100644
index 000000000000..fe1a363da1e7
--- /dev/null
+++ b/arch/arm/boards/skov-dol63x/env/nv/boot.default
@@ -0,0 +1 @@
+bootchooser
diff --git a/arch/arm/boards/skov-dol63x/env/nv/linux.bootargs.hdmi b/arch/arm/boards/skov-dol63x/env/nv/linux.bootargs.hdmi
new file mode 100644
index 000000000000..fe1a363da1e8
--- /dev/null
+++ b/arch/arm/boards/skov-dol63x/env/nv/linux.bootargs.hdmi
@@ -0,0 +1 @@
+video=HDMI-A-1:800x480-24@60e
