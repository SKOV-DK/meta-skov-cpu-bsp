From: =?UTF-8?q?Ulrich=20=C3=96lmann?= <u.oelmann@pengutronix.de>
Date: Tue, 27 Sep 2016 09:08:52 +0200
Subject: [PATCH] blspec: fix return value of entry_is_of_compatible()
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

The function returns a boolean and not an integer. Hence the former
explicit/implicit cast of an ERR_PTR to a boolean has led to a return value of
true although a bootspec entry with a faulty devicetree is not compatible.

Signed-off-by: Ulrich Ã–lmann <u.oelmann@pengutronix.de>
---
 common/blspec.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/common/blspec.c b/common/blspec.c
index 36f9245b2255..d6439cfb15f0 100644
--- a/common/blspec.c
+++ b/common/blspec.c
@@ -295,7 +295,7 @@ static bool entry_is_of_compatible(struct blspec_entry *entry)
 
 	root = of_unflatten_dtb(fdt);
 	if (IS_ERR(root)) {
-		ret = PTR_ERR(root);
+		ret = false;
 		root = NULL;
 		goto out;
 	}
