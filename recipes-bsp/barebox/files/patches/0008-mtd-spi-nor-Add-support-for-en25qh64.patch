From: =?UTF-8?q?Ulrich=20=C3=96lmann?= <u.oelmann@pengutronix.de>
Date: Mon, 9 Dec 2019 12:18:04 +0100
Subject: [PATCH] mtd: spi-nor: Add support for en25qh64
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

This is a port of Linux kernel commit

| commit 30a2c8aa3c520d54bcaf3015ca8141b0156448b1
| Author: Roger Pueyo Centelles <roger.pueyo@guifi.net>
| Date:   Thu Feb 7 20:09:35 2019 +0100
|
|     mtd: spi-nor: Add support for en25qh64
|
|     The Eon EN25QH64 is a 64 Mbit SPI NOR flash memory chip found
|     on recent wireless routers. Its 32, 128 and 256 Mbit siblings
|     are already supported.
|
|     Tested on a COMFAST CF-E120A v3 router board.
|
|     Signed-off-by: Roger Pueyo Centelles <roger.pueyo@guifi.net>
|     Reviewed-by: Tudor Ambarus <tudor.ambarus@microchip.com>
|     Signed-off-by: Boris Brezillon <boris.brezillon@collabora.com>

Signed-off-by: Ulrich Ã–lmann <u.oelmann@pengutronix.de>
---
 drivers/mtd/spi-nor/spi-nor.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/drivers/mtd/spi-nor/spi-nor.c b/drivers/mtd/spi-nor/spi-nor.c
index b2510359826e..261f13db2415 100644
--- a/drivers/mtd/spi-nor/spi-nor.c
+++ b/drivers/mtd/spi-nor/spi-nor.c
@@ -646,6 +646,8 @@ static const struct spi_device_id spi_nor_ids[] = {
 	{ "en25q32b",   INFO(0x1c3016, 0, 64 * 1024,   64, 0) },
 	{ "en25p64",    INFO(0x1c2017, 0, 64 * 1024,  128, 0) },
 	{ "en25q64",    INFO(0x1c3017, 0, 64 * 1024,  128, SECT_4K) },
+	{ "en25qh64",   INFO(0x1c7017, 0, 64 * 1024,  128,
+			SECT_4K | SPI_NOR_DUAL_READ) },
 	{ "en25qh128",  INFO(0x1c7018, 0, 64 * 1024,  256, 0) },
 	{ "en25qh256",  INFO(0x1c7019, 0, 64 * 1024,  512, 0) },
 	{ "en25s64",	INFO(0x1c3817, 0, 64 * 1024,  128, 0) },
